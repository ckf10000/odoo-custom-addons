<odoo>
    <data>
        <!-- views -->
        <record model="ir.ui.view" id="list_collection_record">  
            <field name="name">催收记录</field>  
            <field name="model">history.collection.record</field>  
            <field name="arch" type="xml">
                <tree create="0" delete="0">
                    <field name="collection_stage"/>
                    <field name="overdue_days"/>
                    <field name="user_id"/>
                    <field name="relation_selection"/>
                    <field name="phone_no"/>
                    <field name="collection_type"/>
                    <field name="contact_result"/>
                    <field name="remark"/>
                    <field name="file_ids" widget="btn_field"/>
                    <field name="create_date" string="跟进时间"/>
                    <field name="collector_id"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="history_collection_record_form">  
            <field name="name">催收记录</field>  
            <field name="model">history.collection.record</field>  
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="id" invisible="1" />
                                <field name="collection_order_id" string="催收订单" invisible="1" />
                                <field name="sequence" string="序号" />  
                                <field name="collection_stage" string="催收阶段"/>
                                <field name="overdue_days" string="逾期天数"/> 
                                <field name="user_id" string="催收对象" />  
                                <field name="relation_selection" string="与本人关系"/>  
                                <field name="phone_no" string="跟踪电话"/>
                                <field name="file_ids" string="附件图片" widget="many2many_binary"/>  
                            </group>
                            <group>
                                <field name="collection_type" string="催收形式"/>  
                                <field name="contact_result" string="联络结果"/>  
                                <field name="create_date" string="跟进时间"/>  
                                <field name="collector_id" string="催收员"/>   
                                <field name="remark" string="备注"/> 
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        

        <record id="act_history_collection_record" model="ir.actions.act_window">
            <field name="name">催收记录</field>
            <field name="res_model">history.collection.record</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="context">{'default_res_model': 'collection.order'}</field>
        </record>
                
        <record model="ir.ui.view" id="collection_order_allot_list">
            <field name="name">待分配订单</field>
            <field name="model">collection.order</field>
            <field name="arch" type="xml">
                <tree create="0" import="0" export_xlsx="1" limit="20" default_order="collection_stage, overdue_days">
                    <header>
                        <button class="btn-primary" name="action_manual_allocation" type="object" string="手动分配" display="always"/>
                    </header>
                    <field name="order_no" string="订单编号" optional="show"/>
                    <field name="loan_uid" string="UserID" optional="show"/>
                    <field name="order_type" string="订单类型" optional="show"/>
                    <field name="name" string="姓名" optional="show"/>
                    <field name="phone_no" string="手机号码" optional="show"/>
                    <field name="card_num" string="证件号码" optional="show"/>
                    <field name="application_time" string="申请时间" optional="show"/>
                    <field name="contract_amount" string="合同金额" optional="show"/>
                    <field name="borrow_money_date" string="借款期限" optional="show"/>
                    <field name="repay_date" string="应还日期" widget="date" optional="show"/>
                    <field name="pending_amount" string="挂账金额" optional="show"/>
                    <field name="overdue_days" string="逾期天数" optional="show"/>
                    <field name="collection_stage" string="催收阶段" optional="show"/>
                    <field name="product_id" string="产品名称" optional="show"/>
                    <field name="app_name" string="APP名称" optional="show"/>
                    <field name="version" string="版本号" optional="show"/>
                    <button name="action_look_over" type="object" string="查看"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="collection_order_allot_form">
            <field name="name">订单详情</field>
            <field name="model">collection.order</field>
            <field name="arch" type="xml">
                <form string="待分配订单" edit="1" create="0" delete="0">  
                    <sheet>  
                            <group string="订单信息" name="order_info" col="3">  
                                <group>  
                                    <field name="order_no" string="订单编号" optional="show" readonly="1"/>  
                                    <field name="contract_amount" string="合同金额" optional="show" readonly="1"/>  
                                    <field name="application_time" string="申请时间" optional="show" readonly="1"/>  
                                    <field name="repay_amount" string="应还本息" optional="show" readonly="1"/>  
                                    <field name="contract_amount" string="应还本金" optional="show" readonly="1"/>  
                                    <field name="pending_amount" string="挂账金额" optional="show" readonly="1"/>  
                                    <field name="repayed_amount" string="已还金额" optional="show" readonly="1"/>  
                                    <field name="renewal_repayment_amount" string="申请展期需支付金额" optional="show" readonly="1"/>  
                                    <field name="add_renewal_no" string="累计展期次数" optional="show" readonly="1"/>  
                                    <field name="app_name" string="APP名称" optional="show" readonly="1"/>  
                                </group>  
                                <group colspan="1">  
                                    <field name="order_type" string="订单类型" optional="show" readonly="1" />  
                                    <field name="loan_amount" string="放款金额" optional="show" readonly="1" />  
                                    <field name="pay_complete_time" string="放款成功时间" optional="show" readonly="1" />  
                                    <field name="overdue_fee" string="应还罚息" optional="show" readonly="1"/>  
                                    <field name="derate_amount" string="减免金额" optional="show" readonly="1"/>  
                                    <field name="apply_time" string="展期申请时间" optional="show" readonly="1"/>  
                                    <field name="product_id" string="产品名称" optional="show" readonly="1" />  
                                </group>  
                                <group colspan="1">  
                                    <field name="borrow_money_date" string="借款期限" optional="show" readonly="1"/>  
                                    <field name="repay_date" string="应还日期" widget="date" optional="show" readonly="1"/>  
                                    <field name="late_fee" string="应还滞纳金" optional="show" readonly="1"/>  
                                    <field name="overdue_days" string="逾期天数" optional="show" readonly="1"/>  
                                    <field name="extend_success_time" string="展期完成时间" optional="show" readonly="1"/>  
                                    <field name="repay_platform_order_no" string="还款序列号" optional="show" readonly="1"/>  
                                </group>  
                            </group>  
                            <group string="身份信息" name="id_info" col="3">  
                                <group>  
                                    <field name="loan_uid" string="UserID" optional="show" readonly="1"/>  
                                    <field name="gender_code" string="性别" optional="show" readonly="1"/>  
                                    <field name="marital_status_code" string="婚姻状况" optional="show" readonly="1"/>  
                                    <field name="loan_purpose_code" string="贷款用途" optional="show" readonly="1"/>  
                                    <field name="pay_day_code" string="发薪日" optional="show" readonly="1"/>  
                                </group>  
                                <group>  
                                    <field name="name" string="姓名" optional="show" readonly="1"/>  
                                    <field name="birth_date" string="出生日期" optional="show" readonly="1"/>  
                                    <field name="housing_status_code" string="住房情况" optional="show" readonly="1"/>  
                                    <field name="occupation_code" string="职业" optional="show" readonly="1"/>  
                                    <field name="card_num" string="身份证号码" optional="show" readonly="1"/>  
                                </group>  
                                <group>
                                    <field name="phone_no" string="手机号码" optional="show" readonly="1"/>
                                    <field name="education_code" string="学历" optional="show" readonly="1"/>
                                    <field name="children_num_code" string="子女数量" optional="show" readonly="1"/>
                                    <field name="salary_code" string="薪资" optional="show" readonly="1"/>
                                </group> 
                            </group>  
                            <group col="5" string="活体&amp;证照信息" name="body_info" >
                                <group colspan="1">
                                    <!-- <field name="pan_front_img" string="PAN卡正面照" optional="hide" readonly="1"/> -->
                                    <field name="pan_front_img" string="PAN卡正面照" widget="image" options='{"zoom":true}' readonly="1"/>
                                </group>
                                <group colspan="1">
                                    <field name="pan_back_img" string="PAN卡背面照" widget="image" options='{"zoom":true}'  readonly="1"/>                                 
                                </group>
                                <group colspan="1">
                                    <field name="id_front_img" string="ID卡正面照" widget="image" options='{"zoom":true}' readonly="1"/>                                 
                                </group>
                                <group colspan="1">
                                    <field name="id_hand_img" string="ID卡手持照" widget="image" options='{"zoom":true}' readonly="1"/>                                 
                                </group>
                                <group colspan="1">
                                        <field name="body_discern_img" string="活体识别照" widget="image" optional="show" readonly="1"/>
                                </group>
                            </group>                             
                            <notebook>  
                                <page string="联系人信息">  
                                    <group name="user_info">
                                        <!--<button class="btn-primary" name="action_add_contact" type="object" string="补充联系人" display="always"/>-->
                                        <field name="collection_user_contact_ids" string="联系人信息" edit="1" create="1" delete="0" nolabel="1" colspan="2"> 
                                            <tree editable="bottom" delete="0">
                                                <field name="can_edit" invisible="1"/>
                                                <field name="sequence" string="序号" widget="handle" readonly="not can_edit" width="50px"/>
                                                <field name="name" string="联系人姓名" required="1" readonly="not can_edit"/>
                                                <field name="relation_selection" string="关系" required="1" readonly="not can_edit"/>
                                                <field name="phone_no" string="电话" required="1" readonly="not can_edit"/>
                                                <field name="add_date" string="补充时间" readonly="1"/>
                                                <field name="add_user_id" string="操作人" readonly="1"/>
                                                <!-- <button name="action_edit" type="object" string="编辑"/> -->
                                                <button name="unlink" type="object" icon="fa-trash-o" title="删除" invisible="not can_edit"/>
                                            </tree>
                                        </field>
                                    </group>
                                </page>  
                            </notebook>
                            <notebook>  
                                <page string="通讯录">  
                                    <field name="user_address_book_ids" readonly="1">  
                                        <tree>  
                                            <field name="sequence" string="序号"/>  
                                            <field name="name" string="姓名"/>  
                                            <field name="phone_no" string="电话号码"/>  
                                        </tree>  
                                    </field>  
                                </page>  
                                <page string="通话记录">  
                                    <field name="user_call_record_ids" readonly="1">  
                                        <tree>  
                                            <field name="sequence" string="序号"/>  
                                            <field name="name" string="姓名"/>  
                                            <field name="phone_no" string="电话号码"/>  
                                            <field name="call_type" string="通话类型"/>  
                                            <field name="call_time" string="通话时间"/>  
                                            <field name="total_call_times" string="通话总次数"/>  
                                            <field name="total_call_duration" string="通话总时长(m)"/>  
                                        </tree>  
                                    </field>  
                                </page>
                            </notebook>    
                            
                            <notebook>     
                                <page string="催收记录"> 
                                    <field name="history_collection_record_ids" readonly="1">  
                                        <tree>  
                                            <field name="sequence" string="序号"/>  
                                            <field name="collection_stage" string="催收阶段"/>
                                            <field name="overdue_days" string="逾期天数"/> 
                                            <field name="user_id" string="催收对象"/>  
                                            <field name="relation_selection" string="与本人关系"/>  
                                            <field name="phone_no" string="跟踪电话"/>  
                                            <field name="collection_type" string="催收形式"/>  
                                            <field name="contact_result" string="联络结果"/>  
                                            <field name="remark" string="备注"/>  
                                            <field name="file_ids" string="附件图片" widget="many2many_binary"/>  
                                            <field name="create_date" string="跟进时间"/>  
                                            <field name="collector_id" string="催收员"/>  
                                        </tree>  
                                    </field>  
                                </page>  
                            </notebook>                                     
                            <notebook>     
                                <page string="借款记录">
                                    <field name="loan_order_ids" readonly="1">  
                                        <tree>  
                                            <!-- <field name="sequence" string="序号"/>   -->
                                            <field name="order_no" string="订单编号"/>  
                                            <field name="product_id" />  
                                            <field name="contract_amount"/>  
                                            <field name="loan_period" />  
                                            <field name="pending_amount" />  
                                            <field name="apply_time" />
                                            <field name="repay_date" /> 
                                            <field name="order_status" />
                                            <field name="collection_stage_setting_id"/>  
                                            <field name="overdue_days"/>     
                                            <field name="collector_id" />
                                            <button type="object" name="action_show_collection_record" string="催收记录" class="oe_highlight" />
                                        </tree>  
                                    </field>  
                                </page>  
                            </notebook>                                     
                    </sheet>  
                </form>                  
            </field>
        </record>

        <record model="ir.ui.view" id="collection_order_allot_form2">
            <field name="name">待分配订单-手动分单</field>
            <field name="model">collection.order</field>
            <field name="arch" type="xml">
                <form string="待分配订单">
                    <sheet>
                        <notebook>
                            <page string="订单信息" name="order_info">
                                <group>
                                    <field name="order_no" string="订单编号" optional="show"/>
                                    <field name="loan_uid" string="UserID" optional="show"/>
                                    <field name="order_type" string="订单类型" optional="show"/>
                                    <field name="name" string="姓名" optional="show"/>
                                    <field name="phone_no" string="手机号码" optional="show"/>
                                    <field name="card_num" string="证件号码" optional="show"/>
                                    <field name="application_time" string="申请时间" optional="show"/>
                                    <field name="contract_amount" string="合同金额" optional="show"/>
                                    <field name="borrow_money_date" string="借款期限" optional="show"/>
                                    <field name="repay_date" string="应还日期" widget="date" optional="show"/>
                                    <field name="pending_amount" string="挂账金额" optional="show"/>
                                    <field name="overdue_days" string="逾期天数" optional="show"/>
                                    <field name="collection_stage" string="催收阶段" optional="show"/>
                                    <field name="product_id" string="产品名称" optional="show"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>


        <!-- search view -->
        <record model="ir.ui.view" id="collection_order_allot_search">
            <field name="name">待分配订单</field>
            <field name="model">collection.order</field>
            <field name="arch" type="xml">
                <search>
                    <field name="order_no" string="订单编号" optional="show"/>
                    <field name="loan_uid" string="UserID" optional="show"/>
                    <field name="phone_no" string="手机号码" optional="show"/>
                    <field name="order_type" string="订单类型" optional="show"/>
                    <field name="product_id" string="产品名称" optional="show"/>
                    <field name="app_name" string="APP名称" optional="show"/>
                    <field name="collection_stage" string="催收阶段" optional="show"/>
                    <field name="application_time" string="申请时间" optional="show"/>
                </search>
            </field>
        </record>

        <record model="ir.actions.server" id="collection_order_allot_action">
            <field name="name">待分配订单</field>
            <field name="type">ir.actions.server</field>
            <field name="state">code</field>
            <field name="model_id" ref="loan_collection.model_collection_order"/>
            <field name="groups_id" eval="[(4,ref('base.group_user'))]"/>
            <field name="code">
                action = model.action_server_collection_order_allot()
            </field>
        </record>
    </data>
</odoo>
